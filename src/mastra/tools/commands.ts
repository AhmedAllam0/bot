import { createTool } from "@mastra/core/tools";
import { z } from "zod";
import { sharedPool as pool } from "../db/pool";

export const getStartMessage = createTool({
  id: "get-start-message",
  description: "ููุฑุฌุน ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุนูุฏ ุงุณุชุฎุฏุงู /start. ุงุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ ุฏุงุฆูุงู ุนูุฏูุง ูุฑุณู ุงููุณุชุฎุฏู /start",
  inputSchema: z.object({
    telegramId: z.number().describe("ูุนุฑู ุงููุณุชุฎุฏู ุนูู ุชูููุฌุฑุงู"),
    firstName: z.string().optional().describe("ุงูุงุณู ุงูุฃูู ูููุณุชุฎุฏู"),
  }),
  outputSchema: z.object({
    success: z.boolean(),
    message: z.string(),
  }),
  execute: async ({ context, mastra }) => {
    const logger = mastra?.getLogger();
    logger?.info("๐ [Commands] Start command triggered for user:", context.telegramId);
    
    const name = context.firstName || "ุตุฏููู";
    
    const message = `<b>๐ ูุฑุญุจุงู ${name}! ุฃูุง ุจูุช ุฎูุงุตุฉ ุงููุชุจ</b>

ุฃุณุงุนุฏู ูู ุงูุจุญุซ ุนู ุงููุชุจ ูุชุญููููุง ุจุตูุบุฉ PDF!

<b>โโโ โจ ูููุฒุงุชู โโโ</b>
๐ฅ <b>ุชุญููู ุงููุชุจ</b> - ุฃุฑุณู ุงุณู ุฃู ูุชุงุจ
๐ก <b>ุงูุชูุตูุงุช</b> - ุชุฑุดูุญุงุช ุฐููุฉ ุชูุงุณุจู
๐ <b>ุงูููุฎุตุงุช</b> - ููุฎุตุงุช ุดุงููุฉ ูููุชุจ
โญ <b>ุงูููุถูุฉ</b> - ุงุญูุธ ูุชุจู ุงูููุถูุฉ
๐ฌ <b>ุงูุงูุชุจุงุณุงุช</b> - ุญูู ูุฃููุงู ููููุฉ
๐ <b>ุงูููุงุท ูุงูุฃููุงุจ</b> - ุงุฌูุน ุงูููุงุท ูุงุญุตู ุนูู ููุงูุขุช!

<b>โโโ ๐ง ุงูุฃูุงูุฑ โโโ</b>
/search - ๐ ุจุญุซ ุนู ูุชุงุจ
/recommend - ๐ก ุชูุตูุงุช ูุชุจ
/summary - ๐ ููุฎุต ูุชุงุจ
/stats - ๐ ุฅุญุตุงุฆูุงุชู
/leaderboard - ๐ ุงููุชุตุฏุฑูู
/checkin - โจ ุงูุฏุฎูู ุงููููู
/help - โ ุงููุณุงุนุฏุฉ

โโโโโโโโโโโโโโโ
๐ ุฃุฑุณู ุงุณู ุฃู ูุชุงุจ ููุจุญุซ ุนูู!
โโโโโโโโโโโโโโโ`;

    return {
      success: true,
      message,
    };
  },
});

export const getHelpMessage = createTool({
  id: "get-help-message",
  description: "ููุฑุฌุน ุฑุณุงูุฉ ุงููุณุงุนุฏุฉ ุงูุดุงููุฉ ุนูุฏ ุงุณุชุฎุฏุงู /help. ุงุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ ุฏุงุฆูุงู ุนูุฏูุง ูุฑุณู ุงููุณุชุฎุฏู /help ุฃู ูุทูุจ ุงููุณุงุนุฏุฉ",
  inputSchema: z.object({
    telegramId: z.number().describe("ูุนุฑู ุงููุณุชุฎุฏู ุนูู ุชูููุฌุฑุงู"),
  }),
  outputSchema: z.object({
    success: z.boolean(),
    message: z.string(),
  }),
  execute: async ({ context, mastra }) => {
    const logger = mastra?.getLogger();
    logger?.info("โ [Commands] Help command triggered for user:", context.telegramId);
    
    const message = `<b>๐ ุฏููู ุจูุช ุฎูุงุตุฉ ุงููุชุจ ุงูุดุงูู</b>

<b>โโโ ๐ฅ ุชุญููู ุงููุชุจ โโโ</b>
ุฃุฑุณู ุงุณู ุฃู ูุชุงุจ ูุณุฃุจุญุซ ูู ูุฃุฑุณูู PDF ูุจุงุดุฑุฉ!
<i>ูุซุงู: "ุฑูุงูุฉ ุงูููู ุงูุฃุฒุฑู" ุฃู "ูุชุงุจ ุงูุฑุญูู ุงููุฎุชูู"</i>

<b>โโโ ๐ ูุธุงู ุงูุฃููุงุจ ูุงูููุงุท โโโ</b>
ุงุฌูุน ุงูููุงุท ูุชุณูู ุณูู ุงูุฃููุงุจ:

๐ <b>ูุจุชุฏุฆ</b> (0 ููุทุฉ)
๐ <b>ูุงุฑุฆ</b> (100 ููุทุฉ)
๐ <b>ูุซูู</b> (300 ููุทุฉ) ๐ <i>ุดูุงุฏุฉ ุฑูููุฉ</i>
โ๏ธ <b>ุฃุฏูุจ</b> (600 ููุทุฉ)
๐๏ธ <b>ุนุงูู</b> (1000 ููุทุฉ) ๐ <i>Canva Pro ุฃุณุจูุน</i>
๐ฆ <b>ุญููู</b> (1500 ููุทุฉ)
๐ <b>ูููุณูู</b> (2500 ููุทุฉ) ๐ <i>Canva Pro ุดูุฑ</i>
๐ <b>ุฃุณุทูุฑุฉ</b> (4000 ููุทุฉ)
๐ง <b>ุนุจูุฑู</b> (6000 ููุทุฉ) ๐ <i>Canva Pro 3 ุดููุฑ</i>
โญ <b>ุฎุงูุฏ</b> (10000 ููุทุฉ) ๐ <i>ููุงูุฃุฉ ุฎุงุตุฉ</i>

<b>โโโ ๐ฐ ุทุฑู ุฌูุน ุงูููุงุท โโโ</b>
๐ฌ <b>ุงูุฌุฑูุจ:</b> +2 ููู ุฑุณุงูุฉ (ุญุฏ 20 ููููุงู)
โจ <b>ุงูุฏุฎูู ุงููููู:</b> +5 ููุงุท
๐ <b>ุงูุฅุญุงูุงุช:</b> +50 ููููุญููุ +25 ููููุญุงู
๐ <b>ููุงูุขุช ุงูุงุณุชูุฑุงุฑูุฉ:</b> 7 ุฃูุงู=+20ุ 30 ููู=+100

<b>โโโ ๐ ุงูุฃูุงูุฑ โโโ</b>
/search - ๐ ุจุญุซ ุนู ูุชุงุจ
/recommend - ๐ก ุชูุตูุงุช ูุชุจ
/summary - ๐ ููุฎุต ูุชุงุจ
/stats - ๐ ุฅุญุตุงุฆูุงุชู ูููุงุทู
/leaderboard - ๐ ูุงุฆูุฉ ุงููุชุตุฏุฑูู
/checkin - โจ ุงูุฏุฎูู ุงููููู
/referral - ๐ ููุฏ ุงูุฅุญุงูุฉ
/claim - ๐ ุงููุทุงูุจุฉ ุจููุงูุฃุฉ
/favorites - โค๏ธ ูุชุจู ุงูููุถูุฉ
/quotes - ๐ฌ ุงูุชุจุงุณุงุช ููููุฉ

<b>โโโ ๐ก ูุตุงุฆุญ โโโ</b>
โข ุฃุฑุณู ุงุณู ูุชุงุจ ูุจุงุดุฑุฉ ููุจุญุซ ูุงูุชุญููู
โข ุงุณุชุฎุฏู /stats ููุนุฑูุฉ ุชุฑุชูุจู ูููุงุทู
โข ุงุฏุนู ุฃุตุฏูุงุกู ุจููุฏ ุงูุฅุญุงูุฉ ูููุงุท ุฅุถุงููุฉ!`;

    return {
      success: true,
      message,
    };
  },
});

export const getQuotesMessage = createTool({
  id: "get-quotes-message",
  description: "ููุฑุฌุน ุงูุชุจุงุณุงุช ููููุฉ ุนูุฏ ุงุณุชุฎุฏุงู /quotes. ุงุณุชุฎุฏู ูุฐู ุงูุฃุฏุงุฉ ุฏุงุฆูุงู ุนูุฏูุง ูุฑุณู ุงููุณุชุฎุฏู /quotes ุฃู ูุทูุจ ุงูุชุจุงุณุงุช",
  inputSchema: z.object({
    telegramId: z.number().describe("ูุนุฑู ุงููุณุชุฎุฏู ุนูู ุชูููุฌุฑุงู"),
  }),
  outputSchema: z.object({
    success: z.boolean(),
    message: z.string(),
  }),
  execute: async ({ context, mastra }) => {
    const logger = mastra?.getLogger();
    logger?.info("๐ฌ [Commands] Quotes command triggered for user:", context.telegramId);
    
    const quotes = [
      { text: "ุงููุฑุงุกุฉ ุชููุญู ุญูุงุฉ ุฃุฎุฑู", author: "ุนุจุงุณ ูุญููุฏ ุงูุนูุงุฏ" },
      { text: "ุงููุชุงุจ ุฎูุฑ ุฌููุณ", author: "ุงููุชูุจู" },
      { text: "ูู ูู ููุฑุฃ ุงูุชุงุฑูุฎุ ูุญููู ุนููู ุจุชูุฑุงุฑู", author: "ุฌูุฑุฌ ุณุงูุชูุงูุง" },
      { text: "ููุณ ููุงู ุตุฏูู ุฃููู ูู ุงููุชุงุจ", author: "ูููุบูุงู" },
      { text: "ุบุฑูุฉ ุจุฏูู ูุชุจ ูุฌุณุฏ ุจูุง ุฑูุญ", author: "ุดูุดุฑูู" },
      { text: "ุงูุฑุฃ ูุชุงุจุงู ุฌูุฏุงู ุซูุงุซ ูุฑุงุช ุฃููุน ูู ูู ุฃู ุชูุฑุฃ ุซูุงุซุฉ ูุชุจ ุฌุฏูุฏุฉ", author: "ุงูุฌุงุญุธ" },
      { text: "ุงูุนูู ูู ุงูุตุบุฑ ูุงูููุด ูู ุงูุญุฌุฑ", author: "ุญููุฉ ุนุฑุจูุฉ" },
      { text: "ุฎูุฑ ุงูููุงู ูุง ูู ูุฏู", author: "ุญููุฉ ุนุฑุจูุฉ" },
    ];
    
    const randomQuotes = quotes.sort(() => Math.random() - 0.5).slice(0, 4);
    
    let message = `<b>๐ฌ ุงูุชุจุงุณุงุช ููููุฉ</b>\n\n`;
    randomQuotes.forEach((q, i) => {
      message += `${i + 1}. <i>"${q.text}"</i>\n   โ <b>${q.author}</b>\n\n`;
    });
    message += `โโโโโโโโโโโโโโโ\nโจ ุฃุฑุณู /quotes ูุฑุฉ ุฃุฎุฑู ูุงูุชุจุงุณุงุช ุฌุฏูุฏุฉ!`;

    return {
      success: true,
      message,
    };
  },
});
